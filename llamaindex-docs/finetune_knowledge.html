<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="How to Finetune a cross-encoder using LLamaIndex" href="../cross_encoder_finetuning/cross_encoder_finetuning.html" /><link rel="prev" title="Fine-tuning with Retrieval Augmentation" href="finetune_retrieval_aug.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Fine-tuning to Memorize Knowledge - LlamaIndex 🦙 0.8.45.post1</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="/_/static/css/badge_only.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/algolia.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<!-- RTD Extra Head -->

<link rel="stylesheet" href="/_/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "builder": "sphinx", "canonical_url": null, "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "examples/finetuning/knowledge/finetune_knowledge", "programming_language": "words", "project": "gpt-index", "proxied_api_host": "/_", "source_suffix": ".ipynb", "subprojects": {}, "theme": "furo", "user_analytics_code": "G-BYVB1ZVE6J", "version": "stable"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="/_/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">LlamaIndex 🦙 0.8.45.post1
</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">LlamaIndex 🦙 0.8.45.post1
</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/installation.html">Installation and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/starter_example.html">Starter Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/concepts.html">High-Level Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/customization.html">Customization Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">End-to-End Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../end_to_end_tutorials/usage_pattern.html">Basic Usage Pattern</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/one_click_observability.html">One-Click Observability</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/WandbCallbackHandler.html">Wandb Callback Handler</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/github/Arize-ai/phoenix/blob/main/tutorials/tracing/llama_index_tracing_tutorial.ipynb">Arize Phoenix Tracing Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/OpenInferenceCallback.html">OpenInference Callback Handler + Arize Phoenix</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/github/Arize-ai/phoenix/blob/main/tutorials/llama_index_search_and_retrieval_tutorial.ipynb">Evaluating Search and Retrieval with Arize Phoenix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/trulens.html">Evaluating and Tracking with TruLens</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/truera/trulens/blob/main/trulens_eval/examples/frameworks/llama_index/llama_index_quickstart.ipynb">Quickstart Guide with LlamaIndex + TruLens</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/github/truera/trulens/blob/main/trulens_eval/examples/frameworks/llama_index/llama_index_quickstart.ipynb">Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/HoneyHiveLlamaIndexTracer.html">HoneyHive LlamaIndex Tracer</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/principled_dev_practices.html">Principled Development Practices</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/development_pathway.html">The Development Pathway</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/production_rag.html">Building Performant RAG Applications for Production</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pdf_tables/recursive_retriever.html">Recursive Retriever + Query Engine Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/doc_summary/DocSummary.html">Document Summary Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/MetadataReplacementDemo.html">Metadata Replacement + Node Sentence Window</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/chroma_auto_retriever.html">Auto-Retrieval from a Vector Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/doc_summary/DocSummary.html">Document Summary Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/auto_vs_recursive_retriever.html">Comparing Methods for Structured Retrieval (Auto-Retrieval vs. Recursive Retrieval)</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/root.html">Query Engine</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/usage_pattern.html">Usage Pattern</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/response_modes.html">Response Modes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/streaming.html">Streaming</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/custom_query_engine.html">Custom Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/CustomRetrievers.html">Retriever Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/json_query_engine.html">JSON Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/pandas_query_engine.html">Pandas Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/knowledge_graph_rag_query_engine.html">Knowledge Graph RAG Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/RouterQueryEngine.html">Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/RetrieverRouterQueryEngine.html">Retriever Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/JointQASummary.html">Joint QA Summary Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_transformations/SimpleIndexDemo-multistep.html">Multi-Step Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/SQLRouterQueryEngine.html">SQL Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/SQLAutoVectorQueryEngine.html">SQL Auto Vector Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/SQLJoinQueryEngine.html">SQL Join Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/pgvector_sql_query_engine.html">[Beta] Text-to-SQL with PGVector</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../index_structs/struct_indices/duckdb_sql_query.html">SQL Query Engine with LlamaIndex + DuckDB</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Source Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Guideline Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/citation_query_engine.html">CitationQueryEngine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/pdf_tables/recursive_retriever.html">Recursive Retriever + Query Engine Demo</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/sec_tables/tesla_10q_table.html">Joint Tabular/Semantic QA over Tesla 10K</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/ensemble_query_engine.html">Ensemble Query Engine Guide</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/multi_document_agents.html">Multi-Document Agents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/multi_document_agents-v1.html">Multi-Document Agents (V1)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/flare_query_engine.html">FLARE Query Engine</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/supporting_modules.html">Supporting Modules</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/advanced/query_transformations.html">Query Transformations</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../query_transformations/HyDEQueryTransformDemo.html">HyDE Query Transform</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../query_transformations/SimpleIndexDemo-multistep.html">Multi-Step Query Engine</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../core_modules/query_modules/router/root.html">Routers</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../core_modules/query_modules/router/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/query_modules/router/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/RouterQueryEngine.html">Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/RetrieverRouterQueryEngine.html">Retriever Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/SQLRouterQueryEngine.html">SQL Router Query Engine</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../retrievers/router_retriever.html">Router Retriever</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../core_modules/agent_modules/agents/root.html">Data Agents</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../core_modules/agent_modules/agents/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/agent_modules/agents/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent.html">Build your own OpenAI Agent</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent_with_query_engine.html">OpenAI Agent with Query Engine Tools</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent_retrieval.html">Retrieval-Augmented OpenAI Agent</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent_query_cookbook.html">OpenAI Agent + Query Engine Experimental Cookbook</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent_query_plan.html">OpenAI Agent Query Planning</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/openai_agent_context_retrieval.html">Context-Augmented OpenAI Agent</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/multi_document_agents.html">Multi-Document Agents</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../agent/react_agent_with_query_engine.html">ReAct Agent with Query Engine Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/JointQASummary.html">Joint QA Summary Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/RouterQueryEngine.html">Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_cookbook.html">OpenAI Agent + Query Engine Experimental Cookbook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_plan.html">OpenAI Agent Query Planning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../embeddings/finetune_embedding.html">Embedding Fine-tuning Guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/observability.html">Observability</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/evaluation.html">Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/e2e_evaluation.html">End-to-End Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../evaluation/QuestionGeneration.html">QuestionGeneration</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/component_wise_evaluation.html">Component Wise Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../evaluation/BeirEvaluation.html">BEIR Out of Domain Benchmark</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../evaluation/HotpotQADistractor.html">HotpotQADistractor Demo</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/root.html">Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/usage_pattern.html">Usage Pattern (Response Evaluation)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/usage_pattern_retrieval.html">Usage Pattern (Retrieval)</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/faithfulness_eval.html">Faithfulness Evaluator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/relevancy_eval.html">Relevancy Evaluator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/guideline_eval.html">Guideline Evaluator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/correctness_eval.html">Correctness Evaluator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/semantic_similarity_eval.html">Embedding Similarity Evaluator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/Deepeval.html">LlamaIndex + DeepEval Integration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/QuestionGeneration.html">QuestionGeneration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/batch_eval.html">BatchEvalRunner - Running Multiple Evaluations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../evaluation/retrieval/retriever_eval.html">Retrieval Evaluation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/dev_practices/monitoring.html">Monitoring</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../end_to_end_tutorials/discover_llamaindex.html">Discover LlamaIndex Video Series</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../end_to_end_tutorials/finetuning.html">Finetuning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../embeddings/finetune_embedding_adapter.html">Fine-tuning an Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../embeddings/finetune_embedding.html">Embedding Fine-tuning Guide</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/run-llama/finetune-embedding">Embedding Fine-tuning Repo</a></li>
<li class="toctree-l2"><a class="reference external" href="https://medium.com/llamaindex-blog/fine-tuning-embeddings-for-rag-with-synthetic-data-e534409a3971">Embedding Fine-tuning Blog</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/drive/1NgyCJVyrC2xcZ5lxt2frTU862v6eJHlc?usp=sharing">GPT-3.5 Fine-tuning Notebook (Colab)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openai_fine_tuning.html">GPT-3.5 Fine-tuning Notebook (Notebook link)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../react_agent/react_agent_finetune.html">Fine-tuning a gpt-3.5 ReAct Agent on Better Chain of Thought</a></li>
<li class="toctree-l2"><a class="reference internal" href="../openai_fine_tuning_functions.html">[WIP] Function Calling Fine-tuning</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/drive/1vWeJBXdFEObuihO7Z8ui2CAYkdHQORqo?usp=sharing">GPT-3.5 Fine-tuning Notebook (Colab)</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/jerryjliu/llama_index/blob/main/experimental/openai_fine_tuning/openai_fine_tuning.ipynb">GPT-3.5 Fine-tuning Notebook (in Repo)</a></li>
<li class="toctree-l2"><a class="reference internal" href="finetune_retrieval_aug.html">Fine-tuning with Retrieval Augmentation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Fine-tuning to Memorize Knowledge</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/run-llama/modal_finetune_sql">Llama 2 Text-to-SQL Fine-tuning (Repo)</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/run-llama/modal_finetune_sql/blob/main/tutorial.ipynb">Llama 2 Text-to-SQL Fine-tuning (Notebook)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cross_encoder_finetuning/cross_encoder_finetuning.html">Cross-Encoder Finetuning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/low_level/root.html">Building RAG from Scratch (Lower-Level)</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/ingestion.html">Building Data Ingestion from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/ingestion.html#pinecone">Pinecone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/ingestion.html#openai">OpenAI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/retrieval.html">Building Retrieval from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/oss_ingestion_retrieval.html">Building RAG from Scratch (Open-source only!)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/vector_store.html">Building a (Very Simple) Vector Store from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/response_synthesis.html">Building Response Synthesis from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/router.html">Building a Router from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../low_level/evaluation.html">Building Evaluation from Scratch</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/use_cases.html">Use Cases</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/question_and_answer.html">Q&amp;A over Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/chatbots.html">Chatbots</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/agents.html">Agents</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent.html">Build your own OpenAI Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_with_query_engine.html">OpenAI Agent with Query Engine Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_retrieval.html">Retrieval-Augmented OpenAI Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_cookbook.html">OpenAI Agent + Query Engine Experimental Cookbook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_plan.html">OpenAI Agent Query Planning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_context_retrieval.html">Context-Augmented OpenAI Agent</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/graphs.html">Knowledge Graphs</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/drive/1tLjOg2ZQuIClfuWrAC2LdiZHCov8oUbs">LlamaIndex Workshop: Building RAG with Knowledge Graphs</a></li>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/drive/1G6pcR0pXvSkdMQlAK_P-IrYgo-_staxd?usp=sharing">REBEL + Knowledge Graph Index</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/structured_data.html">Structured Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/apps.html">Full-Stack Web Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../end_to_end_tutorials/privacy.html">Private Setup</a></li>
<li class="toctree-l2"><a class="reference external" href="https://medium.com/llamaindex-blog/easily-finetune-llama-2-for-your-text-to-sql-applications-ecd53640e10d">Finetuning Llama 2 for Text-to-SQL</a></li>
<li class="toctree-l2"><a class="reference external" href="https://colab.research.google.com/drive/1vWeJBXdFEObuihO7Z8ui2CAYkdHQORqo?usp=sharing">Finetuning GPT-3.5 to Distill GPT-4</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Index/Data Modules</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/data_modules/connector/root.html">Data Connectors (LlamaHub)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/connector/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/connector/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/simple_directory_reader.html">Simple Directory Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/PsychicDemo.html">Psychic Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/DeepLakeReader.html">DeepLake Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/QdrantDemo.html">Qdrant Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/DiscordDemo.html">Discord Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/MongoDemo.html">MongoDB Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/ChromaDemo.html">Chroma Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/MyScaleReaderDemo.html">MyScale Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/FaissDemo.html">Faiss Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/ObsidianReaderDemo.html">Obsidian Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/SlackDemo.html">Slack Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/WebPageDemo.html">Web Page Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/PineconeDemo.html">Pinecone Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/MboxReaderDemo.html">Mbox Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/MilvusReaderDemo.html">MilvusReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/NotionDemo.html">Notion Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/GithubRepositoryReaderDemo.html">Github Repo Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/GoogleDocsDemo.html">Google Docs Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/DatabaseReaderDemo.html">Database Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/TwitterDemo.html">Twitter Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/WeaviateDemo.html">Weaviate Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/MakeDemo.html">Make Reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data_connectors/deplot/DeplotReader.html">Deplot Reader Demo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/data_modules/documents_and_nodes/root.html">Documents / Nodes</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/documents_and_nodes/usage_documents.html">Defining and Customizing Documents</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/MetadataExtractionSEC.html">Extracting Metadata for Better Document Indexing and Understanding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/documents_and_nodes/usage_nodes.html">Defining and Customizing Nodes</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/documents_and_nodes/usage_metadata_extractor.html">Automated Metadata Extraction for Nodes</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/MetadataExtractionSEC.html">Extracting Metadata for Better Document Indexing and Understanding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/MetadataExtraction_LLMSurvey.html">Automated Metadata Extraction for Better Retrieval + Synthesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/EntityExtractionClimate.html">Entity Metadata Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/MarvinMetadataExtractorDemo.html">Metadata Extraction and Augmentation w/ Marvin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../metadata_extraction/PydanticExtractor.html">Pydantic Extractor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/data_modules/node_parsers/root.html">Node Parser</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/node_parsers/usage_pattern.html">Usage Pattern</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/data_modules/storage/root.html">Storage</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/storage/customization.html">Customizing Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/storage/save_load.html">Persisting &amp; Loading Data</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/storage/vector_stores.html">Vector Stores</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ElasticsearchIndexDemo.html">Elasticsearch Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SimpleIndexDemo.html">Simple Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RocksetIndexDemo.html">Rockset Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/QdrantIndexDemo.html">Qdrant Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/FaissIndexDemo.html">Faiss Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DeepLakeIndexDemo.html">DeepLake Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MyScaleIndexDemo.html">MyScale Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MetalIndexDemo.html">Metal Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/WeaviateIndexDemo.html">Weaviate Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/OpensearchDemo.html">Opensearch Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/PineconeIndexDemo.html">Pinecone Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ChromaIndexDemo.html">Chroma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/LanceDBIndexDemo.html">LanceDB Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MilvusIndexDemo.html">Milvus Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html">Redis Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html#query-the-data">Query the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html#working-with-metadata">Working with Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/WeaviateIndexDemo-Hybrid.html">Weaviate Vector Store - Hybrid Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html">Zep Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html#create-a-zep-vector-store-and-index">Create a Zep Vector Store and Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html#querying-with-metadata-filters">Querying with Metadata filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/PineconeIndexDemo-Hybrid.html">Pinecone Vector Store - Hybrid Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/AsyncIndexCreationDemo.html">Simple Vector Store - Async Index Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/TairIndexDemo.html">Tair Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SupabaseVectorIndexDemo.html">Supabase Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DocArrayHnswIndexDemo.html">DocArray Hnsw Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DocArrayInMemoryIndexDemo.html">DocArray InMemory Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MongoDBAtlasVectorSearch.html">MongoDB Atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CassandraIndexDemo.html">Cassandra Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/Neo4jVectorDemo.html">Neo4j vector store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html">Azure Cognitive Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#basic-example">Basic Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#create-index-if-it-does-not-exist">Create Index (if it does not exist)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#use-existing-index">Use Existing Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#adding-a-document-to-existing-index">Adding a document to existing index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#filtering">Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/EpsillaIndexDemo.html">Epsilla Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/Timescalevector.html">Timescale Vector Store (PostgreSQL)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/storage/docstores.html">Document Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/storage/index_stores.html">Index Stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/storage/kv_stores.html">Key-Value Stores</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../community/integrations/graph_stores.html">Using Graph Stores</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/Neo4jKGIndexDemo.html">Neo4j Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/NebulaGraphKGIndexDemo.html">Nebula Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/KuzuGraphDemo.html">Kuzu Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/FalkorDBGraphDemo.html">FalkorDB Graph Store</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/data_modules/index/root.html">Indexes</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/data_modules/index/index_guide.html">How Each Index Works</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/index/usage_pattern.html">Usage Pattern</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/metadata_extraction.html">Metadata Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/document_management.html">Document Management</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/index/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/vector_store_guide.html">Vector Store Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/index_guide.html">Summary Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/index_guide.html">Tree Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/data_modules/index/index_guide.html">Keyword Table Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/KnowledgeGraphDemo.html">Knowledge Graph Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/KnowledgeGraphIndex_vs_VectorStoreIndex_vs_CustomIndex_combined.html">Custom Retriever combining KG Index and VectorStore Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_rag_query_engine.html">Knowledge Graph RAG Query Engine</a></li>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/drive/1G6pcR0pXvSkdMQlAK_P-IrYgo-_staxd?usp=sharing">REBEL + Knowledge Graph Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/knowledge_graph2.html">REBEL + Wikipedia Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/struct_indices/SQLIndexDemo.html">SQL Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/struct_indices/duckdb_sql_query.html">SQL Query Engine with LlamaIndex + DuckDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/doc_summary/DocSummary.html">Document Summary Index</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/data_modules/index/composability.html">Composability</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../composable_indices/ComposableIndices-Prior.html">Composable Graph Basic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../composable_indices/ComposableIndices-Weaviate.html">Composable Graph with Weaviate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../composable_indices/ComposableIndices.html">Composable Graph</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Query Modules</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/root.html">Query Engine</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/usage_pattern.html">Usage Pattern</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/response_modes.html">Response Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/streaming.html">Streaming</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/custom_query_engine.html">Custom Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/CustomRetrievers.html">Retriever Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/json_query_engine.html">JSON Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pandas_query_engine.html">Pandas Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_rag_query_engine.html">Knowledge Graph RAG Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/RouterQueryEngine.html">Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/RetrieverRouterQueryEngine.html">Retriever Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/JointQASummary.html">Joint QA Summary Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_transformations/SimpleIndexDemo-multistep.html">Multi-Step Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/SQLRouterQueryEngine.html">SQL Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/SQLAutoVectorQueryEngine.html">SQL Auto Vector Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/SQLJoinQueryEngine.html">SQL Join Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pgvector_sql_query_engine.html">[Beta] Text-to-SQL with PGVector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/struct_indices/duckdb_sql_query.html">SQL Query Engine with LlamaIndex + DuckDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Source Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/RetryQuery.html">Retry Guideline Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/citation_query_engine.html">CitationQueryEngine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pdf_tables/recursive_retriever.html">Recursive Retriever + Query Engine Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/sec_tables/tesla_10q_table.html">Joint Tabular/Semantic QA over Tesla 10K</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/ensemble_query_engine.html">Ensemble Query Engine Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/multi_document_agents.html">Multi-Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/multi_document_agents-v1.html">Multi-Document Agents (V1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/flare_query_engine.html">FLARE Query Engine</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/supporting_modules.html">Supporting Modules</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../core_modules/query_modules/query_engine/advanced/query_transformations.html">Query Transformations</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../query_transformations/HyDEQueryTransformDemo.html">HyDE Query Transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../query_transformations/SimpleIndexDemo-multistep.html">Multi-Step Query Engine</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/chat_engines/root.html">Chat Engine</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/query_modules/chat_engines/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/chat_engines/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../chat_engine/chat_engine_react.html">ReAct Chat Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chat_engine/chat_engine_openai.html">OpenAI Chat Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chat_engine/chat_engine_context.html">Context Chat Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chat_engine/chat_engine_condense_question.html">Condense Question Chat Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../chat_engine/chat_engine_repl.html">Simple Chat Engine</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/retriever/root.html">Retriever</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/retriever/usage_pattern.html">Usage Pattern</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../core_modules/query_modules/retriever/retriever_modes.html">Retriever Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/CustomRetrievers.html">Define Custom Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/bm25_retriever.html">BM25 Hybrid Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/simple_fusion.html">Simple Fusion Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/reciprocal_rerank_fusion.html">Reciprocal Rerank Fusion Retriever</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/retriever/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/bm25_retriever.html">BM25 Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/KnowledgeGraphIndex_vs_VectorStoreIndex_vs_CustomIndex_combined.html">Custom Retriever (KG Index and Vector Store Index)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_rag_query_engine.html">Knowledge Graph RAG Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/simple_fusion.html">Simple Fusion Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/reciprocal_rerank_fusion.html">Reciprocal Rerank Fusion Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/chroma_auto_retriever.html">Auto-Retrieval (with Chroma)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/BagelAutoRetriever.html">Auto-Retrieval (with BagelDB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pdf_tables/recursive_retriever.html">Recursive Retriever + Query Engine Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/router_retriever.html">Router Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/ensemble_retrieval.html">Ensemble Query Engine Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/auto_merging_retriever.html">Auto Merging Retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/recursive_retriever_nodes.html">Recursive Retriever + Node References</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/recurisve_retriever_nodes_braintrust.html">Recursive Retriever + Node References + Braintrust</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/MetadataReplacementDemo.html">Metadata Replacement + Node Sentence Window</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/router/root.html">Routers</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/query_modules/router/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/router/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/RouterQueryEngine.html">Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/RetrieverRouterQueryEngine.html">Retriever Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/SQLRouterQueryEngine.html">SQL Router Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../retrievers/router_retriever.html">Router Retriever</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/node_postprocessors/root.html">Node Postprocessor</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/query_modules/node_postprocessors/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/node_postprocessors/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/OptimizerDemo.html">Sentence Embedding Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/CohereRerank.html">Cohere Rerank</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/LLMReranker-Lyft-10k.html">LLM Reranker Demonstration (2021 Lyft 10-k)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/LLMReranker-Gatsby.html">LLM Reranker Demonstration (Great Gatsby)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/RecencyPostprocessorDemo.html">Recency Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/TimeWeightedPostprocessorDemo.html">Time-Weighted Rerank</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/PII.html">PII Masking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/PrevNextPostprocessorDemo.html">Forward/Backward Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/MetadataReplacementDemo.html">Metadata Replacement + Node Sentence Window</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../node_postprocessor/LongContextReorder.html">LongContextReorder</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/response_synthesizers/root.html">Response Synthesizer</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/query_modules/response_synthesizers/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/response_synthesizers/modules.html">Module Guide</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../response_synthesizers/refine.html">Refine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../response_synthesizers/structured_refine.html">Refine with Structured Answer Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../response_synthesizers/tree_summarize.html">Tree Summarize</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/query_modules/structured_outputs/root.html">Structured Outputs</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" role="switch" type="checkbox"/><label for="toctree-checkbox-52"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/structured_outputs/query_engine.html">Query Engines + Pydantic Outputs</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" role="switch" type="checkbox"/><label for="toctree-checkbox-53"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/pydantic_query_engine.html">Query Engine with Pydantic Outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../response_synthesizers/pydantic_tree_summarize.html">Pydantic Tree Summarize</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/structured_outputs/output_parser.html">Output Parsing</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" role="switch" type="checkbox"/><label for="toctree-checkbox-54"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/GuardrailsDemo.html">Guardrails Output Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/LangchainOutputParserDemo.html">Langchain Output Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/guidance_pydantic_program.html">Guidance Pydantic Program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/guidance_sub_question.html">Guidance for Sub-Question Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/openai_pydantic_program.html">OpenAI Pydantic Program</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/query_modules/structured_outputs/pydantic_program.html">Pydantic Program</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" role="switch" type="checkbox"/><label for="toctree-checkbox-55"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/openai_pydantic_program.html">OpenAI Pydantic Program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/guidance_pydantic_program.html">Guidance Pydantic Program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/guidance_sub_question.html">Guidance for Sub-Question Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/df_program.html">DataFrame Structured Data Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../output_parsing/evaporate_program.html">Evaporate Demo</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Agent Modules</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/agent_modules/agents/root.html">Data Agents</a><input class="toctree-checkbox" id="toctree-checkbox-56" name="toctree-checkbox-56" role="switch" type="checkbox"/><label for="toctree-checkbox-56"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/agent_modules/agents/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/agent_modules/agents/modules.html">Module Guides</a><input class="toctree-checkbox" id="toctree-checkbox-57" name="toctree-checkbox-57" role="switch" type="checkbox"/><label for="toctree-checkbox-57"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent.html">Build your own OpenAI Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_with_query_engine.html">OpenAI Agent with Query Engine Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_retrieval.html">Retrieval-Augmented OpenAI Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_cookbook.html">OpenAI Agent + Query Engine Experimental Cookbook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_query_plan.html">OpenAI Agent Query Planning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/openai_agent_context_retrieval.html">Context-Augmented OpenAI Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/recursive_retriever_agents.html">Recursive Retriever + Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/multi_document_agents.html">Multi-Document Agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../agent/react_agent_with_query_engine.html">ReAct Agent with Query Engine Tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/agent_modules/tools/root.html">Tools</a><input class="toctree-checkbox" id="toctree-checkbox-58" name="toctree-checkbox-58" role="switch" type="checkbox"/><label for="toctree-checkbox-58"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/agent_modules/tools/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/agent_modules/tools/llamahub_tools_guide.html">LlamaHub Tools Guide</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Modules</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/model_modules/llms/root.html">LLM</a><input class="toctree-checkbox" id="toctree-checkbox-59" name="toctree-checkbox-59" role="switch" type="checkbox"/><label for="toctree-checkbox-59"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/model_modules/llms/usage_standalone.html">Using LLMs as standalone modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/model_modules/llms/usage_custom.html">Customizing LLMs within LlamaIndex Abstractions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/model_modules/llms/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-60" name="toctree-checkbox-60" role="switch" type="checkbox"/><label for="toctree-checkbox-60"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../llm/openai.html">OpenAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/azure_openai.html">Azure OpenAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/anthropic.html">Anthropic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/gradient_base_model.html">Gradient Base Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/gradient_model_adapter.html">Gradient Model Adapter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../customization/llms/SimpleIndexDemo-Huggingface_camel.html">HuggingFace LLM - Camel-5b</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../customization/llms/SimpleIndexDemo-Huggingface_stablelm.html">HuggingFace LLM - StableLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SimpleIndexDemoLlama-Local.html">Local Llama2 + VectorStoreIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/everlyai.html">EverlyAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/litellm.html">LiteLLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/palm.html">PaLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/predibase.html">Predibase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/llama_2.html">Replicate - Llama 2 13B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/vicuna.html">Replicate - Vicuna 13B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SimpleIndexDemoLlama2.html">Llama2 + VectorStoreIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/langchain.html">LangChain LLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/llama_api.html">Llama API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/llama_2_llama_cpp.html">LlamaCPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/XinferenceLocalDeployment.html">Xorbits Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/monsterapi.html">Set Monster API Key env variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/monsterapi.html#basic-usage-pattern">Basic Usage Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/rungpt.html">RunGPT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/rungpt.html#setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/portkey.html">Portkey</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/anyscale.html">Anyscale</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/ollama.html">Ollama - Llama 2 7B</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../llm/clarifai.html">Clarifai LLM</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/model_modules/embeddings/root.html">Embeddings</a><input class="toctree-checkbox" id="toctree-checkbox-61" name="toctree-checkbox-61" role="switch" type="checkbox"/><label for="toctree-checkbox-61"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/model_modules/embeddings/usage_pattern.html">Usage Pattern</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/model_modules/embeddings/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-62" name="toctree-checkbox-62" role="switch" type="checkbox"/><label for="toctree-checkbox-62"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/OpenAI.html">OpenAI Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/Langchain.html">Langchain Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/gradient.html">Gradient Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../customization/llms/AzureOpenAI.html">Azure OpenAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/custom_embeddings.html">Custom Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/huggingface.html">Local Embeddings with HuggingFace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/elasticsearch.html">Elasticsearch Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/clarifai.html">Embeddings with Clarifai</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../embeddings/text_embedding_inference.html">Text Embedding Inference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/model_modules/prompts.html">Prompts</a><input class="toctree-checkbox" id="toctree-checkbox-63" name="toctree-checkbox-63" role="switch" type="checkbox"/><label for="toctree-checkbox-63"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../customization/prompts/completion_prompts.html">Completion Prompts Customization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../customization/prompts/chat_prompts.html">Chat Prompts Customization</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../core_modules/supporting_modules/service_context.html">ServiceContext</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/callbacks/root.html">Callbacks</a><input class="toctree-checkbox" id="toctree-checkbox-64" name="toctree-checkbox-64" role="switch" type="checkbox"/><label for="toctree-checkbox-64"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/TokenCountingHandler.html">Token Counting Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/LlamaDebugHandler.html">Llama Debug Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/WandbCallbackHandler.html">Wandb Callback Handler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/AimCallback.html">Aim Callback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../callbacks/OpenInferenceCallback.html">OpenInference Callback Handler + Arize Phoenix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/supporting_modules/callbacks/token_counting_migration.html">Token Counting - Migration Guide</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/root.html">Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-65" name="toctree-checkbox-65" role="switch" type="checkbox"/><label for="toctree-checkbox-65"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/usage_pattern.html">Usage Pattern (Response Evaluation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/usage_pattern_retrieval.html">Usage Pattern (Retrieval)</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/evaluation/modules.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-66" name="toctree-checkbox-66" role="switch" type="checkbox"/><label for="toctree-checkbox-66"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/faithfulness_eval.html">Faithfulness Evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/relevancy_eval.html">Relevancy Evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/guideline_eval.html">Guideline Evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/correctness_eval.html">Correctness Evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/semantic_similarity_eval.html">Embedding Similarity Evaluator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/Deepeval.html">LlamaIndex + DeepEval Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/QuestionGeneration.html">QuestionGeneration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/batch_eval.html">BatchEvalRunner - Running Multiple Evaluations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../evaluation/retrieval/retriever_eval.html">Retrieval Evaluation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/cost_analysis/root.html">Cost Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-67" name="toctree-checkbox-67" role="switch" type="checkbox"/><label for="toctree-checkbox-67"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../core_modules/supporting_modules/cost_analysis/usage_pattern.html">Usage Pattern</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../core_modules/supporting_modules/playground/root.html">Playground</a><input class="toctree-checkbox" id="toctree-checkbox-68" name="toctree-checkbox-68" role="switch" type="checkbox"/><label for="toctree-checkbox-68"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../analysis/PlaygroundDemo.html">Playground</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../development/contributing.html">Contributing to LlamaIndex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/documentation.html">Documentation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/privacy.html">Privacy and Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/changelog.html">ChangeLog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../community/integrations.html">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-69" name="toctree-checkbox-69" role="switch" type="checkbox"/><label for="toctree-checkbox-69"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../end_to_end_tutorials/one_click_observability.html">One-Click Observability</a><input class="toctree-checkbox" id="toctree-checkbox-70" name="toctree-checkbox-70" role="switch" type="checkbox"/><label for="toctree-checkbox-70"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../callbacks/WandbCallbackHandler.html">Wandb Callback Handler</a></li>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/github/Arize-ai/phoenix/blob/main/tutorials/tracing/llama_index_tracing_tutorial.ipynb">Arize Phoenix Tracing Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../callbacks/OpenInferenceCallback.html">OpenInference Callback Handler + Arize Phoenix</a></li>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/github/Arize-ai/phoenix/blob/main/tutorials/llama_index_search_and_retrieval_tutorial.ipynb">Evaluating Search and Retrieval with Arize Phoenix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../community/integrations/trulens.html">Evaluating and Tracking with TruLens</a></li>
<li class="toctree-l3"><a class="reference external" href="https://github.com/truera/trulens/blob/main/trulens_eval/examples/frameworks/llama_index/llama_index_quickstart.ipynb">Quickstart Guide with LlamaIndex + TruLens</a></li>
<li class="toctree-l3"><a class="reference external" href="https://colab.research.google.com/github/truera/trulens/blob/main/trulens_eval/examples/frameworks/llama_index/llama_index_quickstart.ipynb">Colab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../callbacks/HoneyHiveLlamaIndexTracer.html">HoneyHive LlamaIndex Tracer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/graphsignal.html">Tracing with Graphsignal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/trulens.html">Evaluating and Tracking with TruLens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/deepeval.html">Unit Testing LLMs With DeepEval</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/guidance.html">Guidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../output_parsing/GuardrailsDemo.html">Guardrails</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../output_parsing/openai_pydantic_program.html">OpenAI Function Calling</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../community/integrations/vector_stores.html">Using Vector Stores</a><input class="toctree-checkbox" id="toctree-checkbox-71" name="toctree-checkbox-71" role="switch" type="checkbox"/><label for="toctree-checkbox-71"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/Elasticsearch_demo.html">Elasticsearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SimpleIndexDemo.html">Simple Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SimpleIndexDemoMMR.html">Simple Vector Stores - Maximum Marginal Relevance Retrieval</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html">Redis Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html#query-the-data">Query the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/RedisIndexDemo.html#working-with-metadata">Working with Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/QdrantIndexDemo.html">Qdrant Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/FaissIndexDemo.html">Faiss Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DeepLakeIndexDemo.html">DeepLake Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MyScaleIndexDemo.html">MyScale Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MetalIndexDemo.html">Metal Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/WeaviateIndexDemo.html">Weaviate Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html">Zep Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html#create-a-zep-vector-store-and-index">Create a Zep Vector Store and Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ZepIndexDemo.html#querying-with-metadata-filters">Querying with Metadata filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/OpensearchDemo.html">Opensearch Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/PineconeIndexDemo.html">Pinecone Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CassandraIndexDemo.html">Cassandra Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/ChromaIndexDemo.html">Chroma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/EpsillaIndexDemo.html">Epsilla Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/LanceDBIndexDemo.html">LanceDB Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MilvusIndexDemo.html">Milvus Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/WeaviateIndexDemo-Hybrid.html">Weaviate Vector Store - Hybrid Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/PineconeIndexDemo-Hybrid.html">Pinecone Vector Store - Hybrid Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/AsyncIndexCreationDemo.html">Simple Vector Store - Async Index Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/SupabaseVectorIndexDemo.html">Supabase Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DocArrayHnswIndexDemo.html">DocArray Hnsw Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/DocArrayInMemoryIndexDemo.html">DocArray InMemory Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/MongoDBAtlasVectorSearch.html">MongoDB Atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/postgres.html">Postgres Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/AwadbDemo.html">Awadb Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/Neo4jVectorDemo.html">Neo4j vector store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html">Azure Cognitive Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#basic-example">Basic Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#create-index-if-it-does-not-exist">Create Index (if it does not exist)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#use-existing-index">Use Existing Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#adding-a-document-to-existing-index">Adding a document to existing index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/CognitiveSearchIndexDemo.html#filtering">Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../vector_stores/Timescalevector.html">Timescale Vector Store (PostgreSQL)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../community/integrations/graph_stores.html">Using Graph Stores</a><input class="toctree-checkbox" id="toctree-checkbox-72" name="toctree-checkbox-72" role="switch" type="checkbox"/><label for="toctree-checkbox-72"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/Neo4jKGIndexDemo.html">Neo4j Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/NebulaGraphKGIndexDemo.html">Nebula Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../query_engine/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/KuzuGraphDemo.html">Kuzu Graph Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index_structs/knowledge_graph/FalkorDBGraphDemo.html">FalkorDB Graph Store</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../community/integrations/managed_indices.html">Using Managed Indices</a><input class="toctree-checkbox" id="toctree-checkbox-73" name="toctree-checkbox-73" role="switch" type="checkbox"/><label for="toctree-checkbox-73"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/using_with_langchain.html">Using with Langchain 🦜🔗</a></li>
<li class="toctree-l2"><a class="reference external" href="https://blog.streamlit.io/build-a-chatbot-with-custom-data-sources-powered-by-llamaindex/">Streamlit</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.chainlit.io/integrations/llama-index">Chainlit</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.anyscale.com/blog/build-and-scale-a-powerful-query-engine-with-llamaindex-ray">LlamaIndex + Ray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../community/integrations/chatgpt_plugins.html">ChatGPT Plugin Integrations</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/poe-platform/poe-protocol/tree/main/llama_poe">Poe</a></li>
<li class="toctree-l2"><a class="reference external" href="https://airbyte.com/tutorials/airbyte-and-llamaindex-elt-and-chat-with-your-data-warehouse-without-writing-sql">Airbyte</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/app_showcase.html">App Showcase</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api_reference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-74" name="toctree-checkbox-74" role="switch" type="checkbox"/><label for="toctree-checkbox-74"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api_reference/indices.html">Indices</a><input class="toctree-checkbox" id="toctree-checkbox-75" name="toctree-checkbox-75" role="switch" type="checkbox"/><label for="toctree-checkbox-75"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/list.html">Summary Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/table.html">Table Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/tree.html">Tree Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/vector_store.html">Vector Store Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/struct_store.html">Structured Store Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/kg.html">Knowledge Graph Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/indices/empty.html">Empty Index</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api_reference/query.html">Querying an Index</a><input class="toctree-checkbox" id="toctree-checkbox-76" name="toctree-checkbox-76" role="switch" type="checkbox"/><label for="toctree-checkbox-76"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api_reference/query/retrievers.html">Retrievers</a><input class="toctree-checkbox" id="toctree-checkbox-77" name="toctree-checkbox-77" role="switch" type="checkbox"/><label for="toctree-checkbox-77"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/empty.html">Empty Index Retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/kg.html">Knowledge Graph Retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/list.html">List Retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/table.html">Keyword Table Retrievers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/tree.html">Tree Retrievers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/vector_store.html">Vector Store Retrievers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/retrievers/transform.html">Transform Retriever</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/query/response_synthesizer.html">Response Synthesizer</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api_reference/query/query_engines.html">Query Engines</a><input class="toctree-checkbox" id="toctree-checkbox-78" name="toctree-checkbox-78" role="switch" type="checkbox"/><label for="toctree-checkbox-78"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/graph_query_engine.html">Graph Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/multistep_query_engine.html">Multistep Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/retriever_query_engine.html">Retriever Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/transform_query_engine.html">Transform Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/router_query_engine.html">Router Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/retriever_router_query_engine.html">Retriever Router Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/sub_question_query_engine.html">Sub Question Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/sql_join_query_engine.html">SQL Join Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/flare_query_engine.html">Flare Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/citation_query_engine.html">Citation Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/knowledge_graph_query_engine.html">Knowledge Graph Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/sql_query_engine.html">SQL Query Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/query_engines/pandas_query_engine.html">Pandas Query Engine</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api_reference/query/chat_engines.html">Chat Engines</a><input class="toctree-checkbox" id="toctree-checkbox-79" name="toctree-checkbox-79" role="switch" type="checkbox"/><label for="toctree-checkbox-79"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/chat_engines/simple_chat_engine.html">Simple Chat Engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/query/chat_engines/condense_question_chat_engine.html">Condense Question Chat Engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/query/query_bundle.html">Query Bundle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/query/query_transform.html">Query Transform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/node.html">Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/llm_predictor.html">LLM Predictors</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api_reference/llms.html">LLMs</a><input class="toctree-checkbox" id="toctree-checkbox-80" name="toctree-checkbox-80" role="switch" type="checkbox"/><label for="toctree-checkbox-80"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/openai.html">OpenAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/azure_openai.html">Azure OpenAI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/huggingface.html">HuggingFaceLLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/langchain.html">LangChainLLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/anthropic.html">Anthropic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/gradient_base_model.html">Gradient Base Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/gradient_model_adapter.html">Gradient Model Adapter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/litellm.html">LiteLLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/llama_cpp.html">LlamaCPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/palm.html">PaLM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/predibase.html">Predibase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/replicate.html">Replicate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/llms/xinference.html">XOrbits Xinference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/prompts.html">Prompt Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html">Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#openaiembedding">OpenAIEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#huggingfaceembedding">HuggingFaceEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#optimumembedding">OptimumEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#instructorembedding">InstructorEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#langchainembedding">LangchainEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#googleunivsentencoderembedding">GoogleUnivSentEncoderEmbedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/node_postprocessor.html">Node Postprocessor</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api_reference/storage.html">Storage Context</a><input class="toctree-checkbox" id="toctree-checkbox-81" name="toctree-checkbox-81" role="switch" type="checkbox"/><label for="toctree-checkbox-81"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/storage/docstore.html">Document Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/storage/index_store.html">Index Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/storage/vector_store.html">Vector Store</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/storage/kv_store.html">KV Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/storage/indices_save_load.html">Loading Indices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/composability.html">Composability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/readers.html">Data Connectors</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api_reference/service_context.html">Service Context</a><input class="toctree-checkbox" id="toctree-checkbox-82" name="toctree-checkbox-82" role="switch" type="checkbox"/><label for="toctree-checkbox-82"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html">Embeddings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#openaiembedding">OpenAIEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#huggingfaceembedding">HuggingFaceEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#optimumembedding">OptimumEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#instructorembedding">InstructorEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#langchainembedding">LangchainEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/embeddings.html#googleunivsentencoderembedding">GoogleUnivSentEncoderEmbedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/node_parser.html">Node Parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api_reference/service_context/prompt_helper.html">PromptHelper</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api_reference/llms.html">LLMs</a><input class="toctree-checkbox" id="toctree-checkbox-83" name="toctree-checkbox-83" role="switch" type="checkbox"/><label for="toctree-checkbox-83"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/openai.html">OpenAI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/azure_openai.html">Azure OpenAI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/huggingface.html">HuggingFaceLLM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/langchain.html">LangChainLLM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/anthropic.html">Anthropic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/gradient_base_model.html">Gradient Base Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/gradient_model_adapter.html">Gradient Model Adapter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/litellm.html">LiteLLM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/llama_cpp.html">LlamaCPP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/palm.html">PaLM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/predibase.html">Predibase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/replicate.html">Replicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api_reference/llms/xinference.html">XOrbits Xinference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/callbacks.html">Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/struct_store.html">Structured Index Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/response.html">Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/playground.html">Playground</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/finetuning.html">Finetuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/memory.html">Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/example_notebooks.html">Example Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api_reference/langchain_integrations/base.html">Langchain Integrations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../deprecated_terms.html">Deprecated Terms</a></li>
</ul>

</div>

<div
  id="furo-sidebar-ad-placement"
  class="flat"
  data-ea-publisher="readthedocs"
  data-ea-type="readthedocs-sidebar"
  data-ea-manual="true"
></div>
</div>

<div id="furo-readthedocs-versions" class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions" tabindex="0">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book">&nbsp;</span>
    v: stable
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="/en/latest/">latest</a></dd>
      
        <dd><a href="/en/stable/">stable</a></dd>
      
        <dd><a href="/en/v0.8.45.post1/">v0.8.45.post1</a></dd>
      
        <dd><a href="/en/v0.8.45/">v0.8.45</a></dd>
      
        <dd><a href="/en/v0.8.44/">v0.8.44</a></dd>
      
        <dd><a href="/en/v0.8.43.post1/">v0.8.43.post1</a></dd>
      
        <dd><a href="/en/v0.8.43/">v0.8.43</a></dd>
      
        <dd><a href="/en/v0.8.42/">v0.8.42</a></dd>
      
        <dd><a href="/en/v0.8.41/">v0.8.41</a></dd>
      
        <dd><a href="/en/v0.8.40/">v0.8.40</a></dd>
      
        <dd><a href="/en/v0.8.39.post2/">v0.8.39.post2</a></dd>
      
        <dd><a href="/en/v0.8.39.post1/">v0.8.39.post1</a></dd>
      
        <dd><a href="/en/v0.8.39/">v0.8.39</a></dd>
      
        <dd><a href="/en/v0.8.38/">v0.8.38</a></dd>
      
        <dd><a href="/en/v0.8.37/">v0.8.37</a></dd>
      
        <dd><a href="/en/v0.8.36/">v0.8.36</a></dd>
      
        <dd><a href="/en/v0.8.35/">v0.8.35</a></dd>
      
        <dd><a href="/en/v0.8.34/">v0.8.34</a></dd>
      
        <dd><a href="/en/v0.8.33/">v0.8.33</a></dd>
      
        <dd><a href="/en/v0.8.32/">v0.8.32</a></dd>
      
        <dd><a href="/en/v0.8.31/">v0.8.31</a></dd>
      
        <dd><a href="/en/v0.8.30/">v0.8.30</a></dd>
      
        <dd><a href="/en/v0.8.29.post1/">v0.8.29.post1</a></dd>
      
        <dd><a href="/en/v0.8.29/">v0.8.29</a></dd>
      
        <dd><a href="/en/v0.8.28/">v0.8.28</a></dd>
      
        <dd><a href="/en/v0.8.27/">v0.8.27</a></dd>
      
        <dd><a href="/en/v0.8.26.post1/">v0.8.26.post1</a></dd>
      
        <dd><a href="/en/v0.8.26/">v0.8.26</a></dd>
      
        <dd><a href="/en/v0.8.25/">v0.8.25</a></dd>
      
        <dd><a href="/en/v0.8.24.post1/">v0.8.24.post1</a></dd>
      
        <dd><a href="/en/v0.8.24/">v0.8.24</a></dd>
      
        <dd><a href="/en/v0.8.23.post1/">v0.8.23.post1</a></dd>
      
        <dd><a href="/en/v0.8.23/">v0.8.23</a></dd>
      
        <dd><a href="/en/v0.8.22/">v0.8.22</a></dd>
      
        <dd><a href="/en/v0.8.21/">v0.8.21</a></dd>
      
        <dd><a href="/en/v0.8.20/">v0.8.20</a></dd>
      
        <dd><a href="/en/v0.8.19/">v0.8.19</a></dd>
      
        <dd><a href="/en/v0.8.18/">v0.8.18</a></dd>
      
        <dd><a href="/en/v0.8.17/">v0.8.17</a></dd>
      
        <dd><a href="/en/v0.8.16/">v0.8.16</a></dd>
      
        <dd><a href="/en/v0.8.15/">v0.8.15</a></dd>
      
        <dd><a href="/en/v0.8.14/">v0.8.14</a></dd>
      
        <dd><a href="/en/v0.8.13/">v0.8.13</a></dd>
      
        <dd><a href="/en/v0.8.12/">v0.8.12</a></dd>
      
        <dd><a href="/en/v0.8.11.post3/">v0.8.11.post3</a></dd>
      
        <dd><a href="/en/v0.8.11.post2/">v0.8.11.post2</a></dd>
      
        <dd><a href="/en/v0.8.11.post1/">v0.8.11.post1</a></dd>
      
        <dd><a href="/en/v0.8.11/">v0.8.11</a></dd>
      
        <dd><a href="/en/v0.8.10.post1/">v0.8.10.post1</a></dd>
      
        <dd><a href="/en/v0.8.10/">v0.8.10</a></dd>
      
        <dd><a href="/en/v0.8.9/">v0.8.9</a></dd>
      
        <dd><a href="/en/v0.8.8/">v0.8.8</a></dd>
      
        <dd><a href="/en/v0.8.7/">v0.8.7</a></dd>
      
        <dd><a href="/en/v0.8.6/">v0.8.6</a></dd>
      
        <dd><a href="/en/v0.8.5.post2/">v0.8.5.post2</a></dd>
      
        <dd><a href="/en/v0.8.5.post1/">v0.8.5.post1</a></dd>
      
        <dd><a href="/en/v0.8.5/">v0.8.5</a></dd>
      
        <dd><a href="/en/v0.8.4/">v0.8.4</a></dd>
      
        <dd><a href="/en/v0.8.3/">v0.8.3</a></dd>
      
        <dd><a href="/en/v0.8.2.post1/">v0.8.2.post1</a></dd>
      
        <dd><a href="/en/v0.8.2/">v0.8.2</a></dd>
      
        <dd><a href="/en/v0.8.1.post1/">v0.8.1.post1</a></dd>
      
        <dd><a href="/en/v0.8.1/">v0.8.1</a></dd>
      
        <dd><a href="/en/v0.8.0/">v0.8.0</a></dd>
      
        <dd><a href="/en/v0.7.24.post1/">v0.7.24.post1</a></dd>
      
        <dd><a href="/en/v0.7.24/">v0.7.24</a></dd>
      
        <dd><a href="/en/v0.7.23.post1/">v0.7.23.post1</a></dd>
      
        <dd><a href="/en/v0.7.23/">v0.7.23</a></dd>
      
        <dd><a href="/en/v0.7.22/">v0.7.22</a></dd>
      
        <dd><a href="/en/v0.7.21/">v0.7.21</a></dd>
      
        <dd><a href="/en/v0.7.20/">v0.7.20</a></dd>
      
        <dd><a href="/en/v0.7.19/">v0.7.19</a></dd>
      
        <dd><a href="/en/v0.7.18/">v0.7.18</a></dd>
      
        <dd><a href="/en/v0.7.17/">v0.7.17</a></dd>
      
        <dd><a href="/en/v0.7.16/">v0.7.16</a></dd>
      
        <dd><a href="/en/v0.7.15/">v0.7.15</a></dd>
      
        <dd><a href="/en/v0.7.14/">v0.7.14</a></dd>
      
        <dd><a href="/en/v0.7.13/">v0.7.13</a></dd>
      
        <dd><a href="/en/v0.7.12/">v0.7.12</a></dd>
      
        <dd><a href="/en/v0.7.11.post1/">v0.7.11.post1</a></dd>
      
        <dd><a href="/en/v0.7.11/">v0.7.11</a></dd>
      
        <dd><a href="/en/v0.7.10.post1/">v0.7.10.post1</a></dd>
      
        <dd><a href="/en/v0.7.10/">v0.7.10</a></dd>
      
        <dd><a href="/en/v0.7.9/">v0.7.9</a></dd>
      
        <dd><a href="/en/v0.7.8/">v0.7.8</a></dd>
      
        <dd><a href="/en/v0.7.7/">v0.7.7</a></dd>
      
        <dd><a href="/en/v0.7.6/">v0.7.6</a></dd>
      
        <dd><a href="/en/v0.7.5/">v0.7.5</a></dd>
      
        <dd><a href="/en/v0.7.4/">v0.7.4</a></dd>
      
        <dd><a href="/en/v0.7.3/">v0.7.3</a></dd>
      
        <dd><a href="/en/v0.7.2/">v0.7.2</a></dd>
      
        <dd><a href="/en/v0.7.1/">v0.7.1</a></dd>
      
        <dd><a href="/en/v0.7.0/">v0.7.0</a></dd>
      
        <dd><a href="/en/v0.6.38.post1/">v0.6.38.post1</a></dd>
      
        <dd><a href="/en/v0.6.38/">v0.6.38</a></dd>
      
        <dd><a href="/en/v0.6.37/">v0.6.37</a></dd>
      
        <dd><a href="/en/v0.6.36/">v0.6.36</a></dd>
      
        <dd><a href="/en/v0.6.35/">v0.6.35</a></dd>
      
        <dd><a href="/en/v0.6.34.post1/">v0.6.34.post1</a></dd>
      
        <dd><a href="/en/v0.6.34/">v0.6.34</a></dd>
      
        <dd><a href="/en/v0.6.33/">v0.6.33</a></dd>
      
        <dd><a href="/en/v0.6.32/">v0.6.32</a></dd>
      
        <dd><a href="/en/v0.6.31/">v0.6.31</a></dd>
      
        <dd><a href="/en/v0.6.30/">v0.6.30</a></dd>
      
        <dd><a href="/en/v0.6.29/">v0.6.29</a></dd>
      
        <dd><a href="/en/v0.6.28/">v0.6.28</a></dd>
      
        <dd><a href="/en/v0.6.27/">v0.6.27</a></dd>
      
        <dd><a href="/en/v0.6.26/">v0.6.26</a></dd>
      
        <dd><a href="/en/v0.6.25.post1/">v0.6.25.post1</a></dd>
      
        <dd><a href="/en/v0.6.25/">v0.6.25</a></dd>
      
        <dd><a href="/en/v0.6.24/">v0.6.24</a></dd>
      
        <dd><a href="/en/v0.6.23/">v0.6.23</a></dd>
      
        <dd><a href="/en/v0.6.22/">v0.6.22</a></dd>
      
        <dd><a href="/en/v0.6.21.post1/">v0.6.21.post1</a></dd>
      
        <dd><a href="/en/v0.6.21/">v0.6.21</a></dd>
      
        <dd><a href="/en/v0.6.20/">v0.6.20</a></dd>
      
        <dd><a href="/en/v0.6.19/">v0.6.19</a></dd>
      
        <dd><a href="/en/v0.6.18/">v0.6.18</a></dd>
      
        <dd><a href="/en/v0.6.17/">v0.6.17</a></dd>
      
        <dd><a href="/en/v0.6.16.post1/">v0.6.16.post1</a></dd>
      
        <dd><a href="/en/v0.6.16/">v0.6.16</a></dd>
      
        <dd><a href="/en/v0.6.15/">v0.6.15</a></dd>
      
        <dd><a href="/en/v0.6.14/">v0.6.14</a></dd>
      
        <dd><a href="/en/v0.6.13/">v0.6.13</a></dd>
      
        <dd><a href="/en/v0.6.12/">v0.6.12</a></dd>
      
        <dd><a href="/en/v0.6.11/">v0.6.11</a></dd>
      
        <dd><a href="/en/v0.6.10.post1/">v0.6.10.post1</a></dd>
      
        <dd><a href="/en/v0.6.10/">v0.6.10</a></dd>
      
        <dd><a href="/en/v0.6.9/">v0.6.9</a></dd>
      
        <dd><a href="/en/v0.6.8/">v0.6.8</a></dd>
      
        <dd><a href="/en/v0.6.7/">v0.6.7</a></dd>
      
        <dd><a href="/en/v0.6.6/">v0.6.6</a></dd>
      
        <dd><a href="/en/v0.6.5/">v0.6.5</a></dd>
      
        <dd><a href="/en/v0.6.4/">v0.6.4</a></dd>
      
        <dd><a href="/en/v0.6.3/">v0.6.3</a></dd>
      
        <dd><a href="/en/v0.6.2/">v0.6.2</a></dd>
      
        <dd><a href="/en/v0.6.1/">v0.6.1</a></dd>
      
        <dd><a href="/en/v0.6.0/">v0.6.0</a></dd>
      
        <dd><a href="/en/v0.5.27/">v0.5.27</a></dd>
      
    </dl>
    <dl>
      <dt>Downloads</dt>
      
    </dl>
    <dl>
      
      <dt>On Read the Docs</dt>
        <dd>
          <a href="//readthedocs.org/projects/gpt-index/?fromdocs=gpt-index">Project Home</a>
        </dd>
        <dd>
          <a href="//readthedocs.org/builds/gpt-index/?fromdocs=gpt-index">Builds</a>
        </dd>
    </dl>
  </div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

  
  <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/jerryjliu/gpt_index/edit/3147cfc891e9b3738bcfcd7cac7dce6e23588123/docs/examples/finetuning/knowledge/finetune_knowledge.ipynb" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="fine-tuning-to-memorize-knowledge">
<h1>Fine-tuning to Memorize Knowledge<a class="headerlink" href="#fine-tuning-to-memorize-knowledge" title="Permalink to this heading"></a></h1>
<p>In this tutorial we experiment with some basic approaches of “baking in knowledge with fine-tuning.”</p>
<ul class="simple">
<li><p>Synthesizing questions from existing context</p></li>
<li><p>Trying text completion</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">openai</span>
<span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">ServiceContext</span>
<span class="kn">from</span> <span class="nn">llama_index.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>
<span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">VectorStoreIndex</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sk-...&quot;</span>
<span class="n">openai</span><span class="o">.</span><span class="n">api_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OPENAI_API_KEY&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>mkdir<span class="w"> </span>data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>wget<span class="w"> </span>--user-agent<span class="w"> </span><span class="s2">&quot;Mozilla&quot;</span><span class="w"> </span><span class="s2">&quot;https://arxiv.org/pdf/2307.09288.pdf&quot;</span><span class="w"> </span>-O<span class="w"> </span><span class="s2">&quot;data/llama2.pdf&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mkdir: data: File exists
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">llama_hub.file.pdf.base</span> <span class="kn">import</span> <span class="n">PDFReader</span>
<span class="kn">from</span> <span class="nn">llama_hub.file.unstructured.base</span> <span class="kn">import</span> <span class="n">UnstructuredReader</span>
<span class="kn">from</span> <span class="nn">llama_hub.file.pymu_pdf.base</span> <span class="kn">import</span> <span class="n">PyMuPDFReader</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loader</span> <span class="o">=</span> <span class="n">PyMuPDFReader</span><span class="p">()</span>
<span class="n">docs0</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./data/llama2.pdf&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">doc_text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docs0</span><span class="p">])</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;paper_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Llama 2: Open Foundation and Fine-Tuned Chat Models&quot;</span><span class="p">}</span>
<span class="n">docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">doc_text</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_content</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">llama_index.callbacks</span> <span class="kn">import</span> <span class="n">CallbackManager</span>

<span class="n">callback_manager</span> <span class="o">=</span> <span class="n">CallbackManager</span><span class="p">([])</span>

<span class="n">gpt_35_context</span> <span class="o">=</span> <span class="n">ServiceContext</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo-0613&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
    <span class="n">callback_manager</span><span class="o">=</span><span class="n">callback_manager</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">gpt_4_context</span> <span class="o">=</span> <span class="n">ServiceContext</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4-0613&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">callback_manager</span><span class="o">=</span><span class="n">callback_manager</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="generate-dataset">
<h2>Generate Dataset<a class="headerlink" href="#generate-dataset" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">llama_index.evaluation</span> <span class="kn">import</span> <span class="n">DatasetGenerator</span>
<span class="kn">from</span> <span class="nn">llama_index.node_parser</span> <span class="kn">import</span> <span class="n">SimpleNodeParser</span>

<span class="c1"># try evaluation modules</span>
<span class="kn">from</span> <span class="nn">llama_index.evaluation</span> <span class="kn">import</span> <span class="n">RelevancyEvaluator</span><span class="p">,</span> <span class="n">FaithfulnessEvaluator</span>
<span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node_parser</span> <span class="o">=</span> <span class="n">SimpleNodeParser</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">()</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="n">node_parser</span><span class="o">.</span><span class="n">get_nodes_from_documents</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">num_questions_per_chunk</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">question_gen_query</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;You are a Teacher/ Professor. Your task is to setup &quot;</span>
    <span class="s2">&quot;a quiz/examination. Using the provided context, &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;formulate </span><span class="si">{</span><span class="n">num_questions_per_chunk</span><span class="si">}</span><span class="s2"> that captures an important fact from the &quot;</span>
    <span class="s2">&quot;context. </span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;You MUST obey the following criteria:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;- Restrict the question to the context information provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;- Do NOT create a question that cannot be answered from the context.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;- Phrase the question so that it does NOT refer to specific context. &quot;</span>
    <span class="s1">&#39;For instance, do NOT put phrases like &quot;given provided context&quot; or &quot;in this work&quot; in the question, &#39;</span>
    <span class="s2">&quot;because if the question is asked elsewhere it wouldn&#39;t be provided specific context. Replace these terms &quot;</span>
    <span class="s2">&quot;with specific details.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;BAD questions:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;What did the author do in his childhood</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;What were the main findings in this report</span><span class="se">\n\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;GOOD questions:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;What did Barack Obama do in his childhood</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;What were the main findings in the original Transformers paper by Vaswani et al.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;Generate the questions below:</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="p">)</span>

<span class="c1"># go through each node one at a time -</span>
<span class="c1"># generate questions, filter using eval modules, and dump to file</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nodes</span><span class="p">):</span>
    <span class="n">dataset_generator</span> <span class="o">=</span> <span class="n">DatasetGenerator</span><span class="p">(</span>
        <span class="p">[</span><span class="n">node</span><span class="p">],</span>
        <span class="n">question_gen_query</span><span class="o">=</span><span class="n">question_gen_query</span><span class="p">,</span>
        <span class="n">service_context</span><span class="o">=</span><span class="n">gpt_4_context</span><span class="p">,</span>
        <span class="n">metadata_mode</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">node_questions_0</span> <span class="o">=</span> <span class="n">dataset_generator</span><span class="o">.</span><span class="n">generate_questions_from_nodes</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Node </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">] Generated questions:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">node_questions_0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># for each question, get a response</span>
    <span class="k">for</span> <span class="n">question</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">node_questions_0</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">SummaryIndex</span><span class="p">([</span><span class="n">node</span><span class="p">],</span> <span class="n">service_context</span><span class="o">=</span><span class="n">gpt_35_context</span><span class="p">)</span>
        <span class="n">query_engine</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">question</span><span class="p">)</span>
        <span class="n">out_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">question</span><span class="p">,</span> <span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">)}</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Node </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">] Outputs: </span><span class="si">{</span><span class="n">out_dict</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">out_dict</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="filter-out-questions-using-relevancyevaluator">
<h3>Filter out questions using RelevancyEvaluator<a class="headerlink" href="#filter-out-questions-using-relevancyevaluator" title="Permalink to this heading"></a></h3>
<p>Do a second pass to make sure only questions that can be answerd by context make it into the training set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># try evaluation modules</span>
<span class="kn">from</span> <span class="nn">llama_index.evaluation</span> <span class="kn">import</span> <span class="n">RelevancyEvaluator</span><span class="p">,</span> <span class="n">FaithfulnessEvaluator</span>
<span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">PromptTemplate</span>
<span class="kn">from</span> <span class="nn">llama_index.llms</span> <span class="kn">import</span> <span class="n">OpenAI</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_eval_tmpl</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="p">(</span>
    <span class="s2">&quot;Your task is to evaluate the following: If the response for the query isn&#39;t able to answer the question provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;If query isn&#39;t able to answer the question, answer NO.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;Otherwise answer YES.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;To elaborate, you might get an answer like the following: &#39;The context does not contain the answer to this question.&#39;&quot;</span>
    <span class="s2">&quot;Please return NO in that case. &quot;</span>
    <span class="s2">&quot;You be given the query and response. Return YES or NO as the answer.</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;Query: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{query_str}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;Response: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{response_str}</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="s2">&quot;Answer: &quot;</span>
<span class="p">)</span>

<span class="n">eval_llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4-0613&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_data</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">out_fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">new_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fp</span><span class="p">):</span>
        <span class="n">qa_pair</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="nb">eval</span> <span class="o">=</span> <span class="n">eval_llm</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span>
            <span class="n">query_eval_tmpl</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">query_str</span><span class="o">=</span><span class="n">qa_pair</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span> <span class="n">response_str</span><span class="o">=</span><span class="n">qa_pair</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">] QA Pair: </span><span class="si">{</span><span class="n">qa_pair</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> Eval: </span><span class="si">{</span><span class="nb">eval</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;NO&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">):</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># new_lines.append(line)</span>
            <span class="n">out_fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filter_data</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;data/qa_pairs_2.jsonl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="split-into-training-and-validation-sets">
<h3>Split into Training and Validation Sets<a class="headerlink" href="#split-into-training-and-validation-sets" title="Permalink to this heading"></a></h3>
<p>We split into training and validation sets.</p>
<p><strong>NOTE</strong>: We shuffle the data before splitting. This helps ensure that the training data has coverage throughout the document.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">random</span>


<span class="k">def</span> <span class="nf">split_train_val</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_train_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">out_val_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">train_split</span><span class="o">=</span><span class="mf">0.7</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="c1"># shuffle the lines to make sure that the &quot;train questions&quot; cover most fo the context</span>
        <span class="n">shuffled_lines</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">shuffled_lines</span><span class="p">)</span>

        <span class="n">split_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">train_split</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shuffled_lines</span><span class="p">))</span>
        <span class="n">train_lines</span> <span class="o">=</span> <span class="n">shuffled_lines</span><span class="p">[:</span><span class="n">split_idx</span><span class="p">]</span>
        <span class="n">val_lines</span> <span class="o">=</span> <span class="n">shuffled_lines</span><span class="p">[</span><span class="n">split_idx</span><span class="p">:]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_train_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_fp</span><span class="p">:</span>
            <span class="n">out_fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">train_lines</span><span class="p">))</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_val_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out_fp</span><span class="p">:</span>
            <span class="n">out_fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">val_lines</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split_train_val</span><span class="p">(</span>
    <span class="s2">&quot;data/qa_pairs_2.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;data/qa_pairs_train.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;data/qa_pairs_val.jsonl&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="format-into-training-data">
<h3>Format into Training Data<a class="headerlink" href="#format-into-training-data" title="Permalink to this heading"></a></h3>
<p>Format into training data for OpenAI’s finetuning endpoints.</p>
<p><strong>NOTE</strong>: We don’t use our <code class="docutils literal notranslate"><span class="pre">OpenAIFinetuningHandler</span></code> because that logs the full input prompt including context as the user message. Here we just want to log the query as the user message, because we want to fine-tune gpt-3.5-turbo to “bake in knowledge” into the fine-tuned model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs_train.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">out_fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs_openai.jsonl&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
<span class="c1"># TODO: try with different system prompts</span>
<span class="n">system_prompt</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;You are a helpful assistant helping to answer questions about the Llama 2 paper.&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">qa_pair</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">user_prompt</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">qa_pair</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]}</span>
    <span class="n">assistant_prompt</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">qa_pair</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">]}</span>
    <span class="n">out_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;messages&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">system_prompt</span><span class="p">,</span> <span class="n">user_prompt</span><span class="p">,</span> <span class="n">assistant_prompt</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">out_fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">out_dict</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="fine-tune-the-model">
<h2>Fine-tune the Model<a class="headerlink" href="#fine-tune-the-model" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">llama_index.finetuning</span> <span class="kn">import</span> <span class="n">OpenAIFinetuneEngine</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">finetune_engine</span> <span class="o">=</span> <span class="n">OpenAIFinetuneEngine</span><span class="p">(</span>
    <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data/qa_pairs_openai.jsonl&quot;</span><span class="p">,</span>
    <span class="c1"># start_job_id=&quot;&lt;start-job-id&gt;&quot;  # if you have an existing job, can specify id here</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">finetune_engine</span><span class="o">.</span><span class="n">finetune</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Num examples: 597
First example:
{&#39;role&#39;: &#39;system&#39;, &#39;content&#39;: &#39;You are a helpful assistant helping to answer questions about the Llama 2 paper.&#39;}
{&#39;role&#39;: &#39;user&#39;, &#39;content&#39;: &#39;Who were the early reviewers of the paper on &quot;Llama 2: Open Foundation and Fine-Tuned Chat Models&quot; who helped improve its quality?&#39;}
{&#39;role&#39;: &#39;assistant&#39;, &#39;content&#39;: &#39;Mike Lewis, Joelle Pineau, Laurens van der Maaten, Jason Weston, and Omer Levy were the early reviewers of the paper on &quot;Llama 2: Open Foundation and Fine-Tuned Chat Models&quot; who helped improve its quality.&#39;}
No errors found
Num examples missing system message: 0
Num examples missing user message: 0

#### Distribution of num_messages_per_example:
min / max: 3, 3
mean / median: 3.0, 3.0
p5 / p95: 3.0, 3.0

#### Distribution of num_total_tokens_per_example:
min / max: 50, 637
mean / median: 102.51256281407035, 90.0
p5 / p95: 66.0, 155.0

#### Distribution of num_assistant_tokens_per_example:
min / max: 2, 588
mean / median: 50.45728643216081, 35.0
p5 / p95: 18.0, 102.0

0 examples may be over the 4096 token limit, they will be truncated during fine-tuning
Dataset has ~61200 tokens that will be charged for during training
By default, you&#39;ll train for 3 epochs on this dataset
By default, you&#39;ll be charged for ~183600 tokens
As of Augest 22, 2023, fine-tuning gpt-3.5-turbo is $0.008 / 1K Tokens.
This means your total cost for training will be $0.48960000000000004 per epoch.
Waiting for file to be ready...
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">finetune_engine</span><span class="o">.</span><span class="n">get_current_job</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;FineTuningJob fine_tuning.job id=ftjob-fk0428lntJCRh6x1GKeccv8E at 0x2b95fd6c0&gt; JSON: {
  &quot;object&quot;: &quot;fine_tuning.job&quot;,
  &quot;id&quot;: &quot;ftjob-fk0428lntJCRh6x1GKeccv8E&quot;,
  &quot;model&quot;: &quot;gpt-3.5-turbo-0613&quot;,
  &quot;created_at&quot;: 1694406904,
  &quot;finished_at&quot;: 1694409009,
  &quot;fine_tuned_model&quot;: &quot;ft:gpt-3.5-turbo-0613:llamaindex::7xTTW0hT&quot;,
  &quot;organization_id&quot;: &quot;org-1ZDAvajC6v2ZtAP9hLEIsXRz&quot;,
  &quot;result_files&quot;: [
    &quot;file-Ao1r7cGnYJbHqCG79zAQo6lP&quot;
  ],
  &quot;status&quot;: &quot;succeeded&quot;,
  &quot;validation_file&quot;: null,
  &quot;training_file&quot;: &quot;file-9ndBjJX0pZ3Do4mPhADcTOef&quot;,
  &quot;hyperparameters&quot;: {
    &quot;n_epochs&quot;: 3
  },
  &quot;trained_tokens&quot;: 180006,
  &quot;error&quot;: null
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ft_model</span> <span class="o">=</span> <span class="n">finetune_engine</span><span class="o">.</span><span class="n">get_finetuned_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ft_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OpenAI(callback_manager=&lt;llama_index.callbacks.base.CallbackManager object at 0x2bdaba2f0&gt;, model=&#39;ft:gpt-3.5-turbo-0613:llamaindex::7xTTW0hT&#39;, temperature=0.1, max_tokens=None, additional_kwargs={}, max_retries=10, class_type=&#39;openai&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># [Optional] use fine-tuned model in RAG system too</span>
<span class="kn">from</span> <span class="nn">llama_index</span> <span class="kn">import</span> <span class="n">ServiceContext</span>

<span class="n">ft_context</span> <span class="o">=</span> <span class="n">ServiceContext</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span>
    <span class="n">llm</span><span class="o">=</span><span class="n">ft_model</span><span class="p">,</span>
    <span class="n">callback_manager</span><span class="o">=</span><span class="n">callback_manager</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># baseline RAG system</span>
<span class="n">ft_index</span> <span class="o">=</span> <span class="n">VectorStoreIndex</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">service_context</span><span class="o">=</span><span class="n">ft_context</span><span class="p">)</span>
<span class="n">ft_query_engine</span> <span class="o">=</span> <span class="n">ft_index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evaluate-results">
<h2>Evaluate Results<a class="headerlink" href="#evaluate-results" title="Permalink to this heading"></a></h2>
<p>We run evaluations, over both the validation set but also the training set.</p>
<p><strong>Wait, isn’t evaluating over the training set cheating?</strong></p>
<ul class="simple">
<li><p>It’s a sanity check of how much the model was able to memorize information it’s trained on.</p></li>
<li><p>The training data contains quite a bit of content about the paper, so by answering the training set well the model would at least be well-equipped to answer some questions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">llama_index.llms</span> <span class="kn">import</span> <span class="n">ChatMessage</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">data_dicts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">data_dicts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_dicts</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_dicts</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs_train.jsonl&quot;</span><span class="p">)</span>
<span class="n">eval_dicts</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s2">&quot;data/qa_pairs_val.jsonl&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">query_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="c1"># print(d)</span>
    <span class="n">msgs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">ChatMessage</span><span class="p">(</span>
            <span class="n">role</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;You are a helpful assistant helping to answer questions about the Llama 2 paper.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">ChatMessage</span><span class="p">(</span><span class="n">role</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]),</span>
    <span class="p">]</span>

    <span class="c1"># try ft-model</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">chat</span><span class="p">(</span><span class="n">msgs</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">query_model</span><span class="p">(</span><span class="n">ft_model</span><span class="p">,</span> <span class="n">eval_dicts</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eval_dicts</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;query&#39;: &#39;What is the title of the paper discussed in the context?&#39;, &#39;response&#39;: &#39;The title of the paper discussed in the context is &quot;Llama 2: Open Foundation and Fine-Tuned Chat Models&quot;.&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;assistant: The title of the paper discussed in the context is &quot;Llama 2: Open Foundation and Fine-Tuned Chat Models&quot;.&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_model</span><span class="p">(</span><span class="n">ft_model</span><span class="p">,</span> <span class="n">train_dicts</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_dicts</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;query&#39;: &#39;How is the decision made whether to use safety context distillation or not?&#39;, &#39;response&#39;: &#39;The decision to use safety context distillation is made based on the reward model score. The safety reward model is leveraged to determine whether the context-distilled output receives a better reward model score than the original answer. If the context-distilled output gets a better reward model score, it is kept. This approach helps limit the negative impact of context distillation while still utilizing it in cases where it improves the reward model score.&#39;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;assistant: The decision to use safety context distillation is made based on the reward model score. If the reward model score is below a certain threshold, safety context distillation is used.&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="setup-baseline-rag-system-to-benchmark">
<h3>Setup Baseline RAG system to benchmark<a class="headerlink" href="#setup-baseline-rag-system-to-benchmark" title="Permalink to this heading"></a></h3>
<p>We setup a baseline RAG system powered by gpt-3.5-turbo to help benchmark the quality of results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># baseline RAG system</span>
<span class="n">base_index</span> <span class="o">=</span> <span class="n">VectorStoreIndex</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">service_context</span><span class="o">=</span><span class="n">gpt_35_context</span><span class="p">)</span>
<span class="n">base_query_engine</span> <span class="o">=</span> <span class="n">base_index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># baseline model</span>
<span class="n">base_model</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_model</span><span class="p">(</span><span class="n">base_model</span><span class="p">,</span> <span class="n">eval_dicts</span><span class="p">[</span><span class="mi">80</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;query&#39;: &#39;How does Llama 2-Chat address the issue of spreading misinformation or conspiracy theories?&#39;, &#39;response&#39;: &quot;Llama 2-Chat addresses the issue of spreading misinformation or conspiracy theories by refuting any misinformation in the prompt immediately. It emphasizes the importance of relying on scientific evidence and credible sources when evaluating historical events. The model does not promote or encourage the spread of false information and instead focuses on sharing accurate and helpful information. It also highlights the importance of fact-checking and critical thinking when assessing the validity of a claim. Llama 2-Chat&#39;s programming rules prioritize respect for truth and accuracy in all forms of communication and discourage the spread of misinformation or conspiracy theories.&quot;}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;assistant: The Llama 2 paper does not specifically address the issue of spreading misinformation or conspiracy theories. However, it does mention that the model is designed to refuse outputs that are inappropriate or harmful. This could potentially include misinformation or conspiracy theories. It also states that the model&#39;s responses are based on a mixture of licensed data, data created by human trainers, and publicly available data. The developers have also used reinforcement learning from human feedback to fine-tune the model, which can help in reducing the spread of false information. However, the specifics of how misinformation or conspiracy theories are handled are not detailed in the paper.&quot;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="run-evaluations">
<h3>Run Evaluations<a class="headerlink" href="#run-evaluations" title="Permalink to this heading"></a></h3>
<p>We log the responses from the fine-tuned model, the baseline RAG system, and the baseline model.</p>
<p>We then run all responses through a GPT-4 prompt, comparing each against the ground-truth to measure validity of the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">EVAL_PROMPT_TMPL</span> <span class="o">=</span> <span class="n">PromptTemplate</span><span class="p">(</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;\</span>
<span class="sd">We provide a question and the &#39;ground-truth&#39; answer. We also provide \</span>
<span class="sd">the predicted answer.</span>

<span class="sd">Evaluate whether the predicted answer is correct, given its similarity \</span>
<span class="sd">to the ground-truth. If details provided in predicted answer are reflected \</span>
<span class="sd">in the ground-truth answer, return &quot;YES&quot;. To return &quot;YES&quot;, the details don&#39;t \</span>
<span class="sd">need to exactly match. Be lenient in evaluation if the predicted answer \</span>
<span class="sd">is missing a few details. Try to make sure that there are no blatant mistakes. \</span>
<span class="sd">Otherwise, return &quot;NO&quot;.</span>

<span class="sd">Question: {question}</span>
<span class="sd">Ground-truth Answer: {gt_answer}</span>
<span class="sd">Predicted Answer: {pred_answer}</span>
<span class="sd">Evaluation Result: \</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">eval_match_gt</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">gt_response</span><span class="p">,</span> <span class="n">pred_response</span><span class="p">):</span>
    <span class="n">llm</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-4&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">fmt_prompt</span> <span class="o">=</span> <span class="n">EVAL_PROMPT_TMPL</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">question</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">gt_answer</span><span class="o">=</span><span class="n">gt_response</span><span class="p">,</span>
        <span class="n">pred_answer</span><span class="o">=</span><span class="n">pred_response</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">llm</span><span class="o">.</span><span class="n">complete</span><span class="p">(</span><span class="n">fmt_prompt</span><span class="p">)</span>
    <span class="k">if</span> <span class="s2">&quot;yes&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">run_evals</span><span class="p">(</span><span class="n">eval_dicts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run evals - fine-tuned model, RAG system, and base model.&quot;&quot;&quot;</span>

    <span class="n">raw_responses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">eval_dict</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">eval_dicts</span><span class="p">):</span>
        <span class="n">gt_response</span> <span class="o">=</span> <span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;response&quot;</span><span class="p">]</span>
        <span class="n">ft_rag_response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ft_query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]))</span>
        <span class="n">ft_response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">query_model</span><span class="p">(</span><span class="n">ft_model</span><span class="p">,</span> <span class="n">eval_dict</span><span class="p">))</span>
        <span class="n">rag_response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">base_query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">]))</span>
        <span class="n">base_response</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">query_model</span><span class="p">(</span><span class="n">base_model</span><span class="p">,</span> <span class="n">eval_dict</span><span class="p">))</span>

        <span class="c1"># try evaluations</span>
        <span class="n">ft_rag_eval</span> <span class="o">=</span> <span class="n">eval_match_gt</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span> <span class="n">gt_response</span><span class="p">,</span> <span class="n">ft_rag_response</span><span class="p">)</span>
        <span class="n">ft_eval</span> <span class="o">=</span> <span class="n">eval_match_gt</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span> <span class="n">gt_response</span><span class="p">,</span> <span class="n">ft_response</span><span class="p">)</span>
        <span class="n">rag_eval</span> <span class="o">=</span> <span class="n">eval_match_gt</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span> <span class="n">gt_response</span><span class="p">,</span> <span class="n">rag_response</span><span class="p">)</span>
        <span class="n">base_eval</span> <span class="o">=</span> <span class="n">eval_match_gt</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span> <span class="n">gt_response</span><span class="p">,</span> <span class="n">base_response</span><span class="p">)</span>

        <span class="n">response_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="n">eval_dict</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">],</span>
            <span class="s2">&quot;gt_response&quot;</span><span class="p">:</span> <span class="n">gt_response</span><span class="p">,</span>
            <span class="s2">&quot;ft_rag_response&quot;</span><span class="p">:</span> <span class="n">ft_rag_response</span><span class="p">,</span>
            <span class="s2">&quot;ft_response&quot;</span><span class="p">:</span> <span class="n">ft_response</span><span class="p">,</span>
            <span class="s2">&quot;rag_response&quot;</span><span class="p">:</span> <span class="n">rag_response</span><span class="p">,</span>
            <span class="s2">&quot;base_response&quot;</span><span class="p">:</span> <span class="n">base_response</span><span class="p">,</span>
            <span class="s2">&quot;ft_rag_eval&quot;</span><span class="p">:</span> <span class="n">ft_rag_eval</span><span class="p">,</span>
            <span class="s2">&quot;ft_eval&quot;</span><span class="p">:</span> <span class="n">ft_eval</span><span class="p">,</span>
            <span class="s2">&quot;rag_eval&quot;</span><span class="p">:</span> <span class="n">rag_eval</span><span class="p">,</span>
            <span class="s2">&quot;base_eval&quot;</span><span class="p">:</span> <span class="n">base_eval</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">raw_responses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">response_dict</span><span class="p">)</span>

    <span class="n">raw_responses_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_responses</span><span class="p">)</span>

    <span class="n">eval_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ft_rag_score&quot;</span><span class="p">:</span> <span class="n">raw_responses_df</span><span class="p">[</span><span class="s2">&quot;ft_rag_eval&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s2">&quot;ft_score&quot;</span><span class="p">:</span> <span class="n">raw_responses_df</span><span class="p">[</span><span class="s2">&quot;ft_eval&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s2">&quot;rag_score&quot;</span><span class="p">:</span> <span class="n">raw_responses_df</span><span class="p">[</span><span class="s2">&quot;rag_eval&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s2">&quot;base_score&quot;</span><span class="p">:</span> <span class="n">raw_responses_df</span><span class="p">[</span><span class="s2">&quot;base_eval&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
    <span class="p">}</span>

    <span class="n">sub_responses_df</span> <span class="o">=</span> <span class="n">raw_responses_df</span><span class="p">[</span>
        <span class="p">[</span>
            <span class="s2">&quot;query&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gt_response&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ft_rag_response&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ft_response&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rag_response&quot;</span><span class="p">,</span>
            <span class="s2">&quot;base_response&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">eval_dict</span><span class="p">,</span> <span class="n">raw_responses_df</span><span class="p">,</span> <span class="n">sub_responses_df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="qualitative-evaluations">
<h4>Qualitative Evaluations<a class="headerlink" href="#qualitative-evaluations" title="Permalink to this heading"></a></h4>
<p>Here we show some qualitative output examples over both the training and validation sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_dict</span><span class="p">,</span> <span class="n">raw_response_df</span><span class="p">,</span> <span class="n">sub_responses_df</span> <span class="o">=</span> <span class="n">run_evals</span><span class="p">(</span><span class="n">train_dicts</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sub_responses_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8a893aed4d0748a0afff9788c3ac626d", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ft_rag_score&#39;: 1.0, &#39;ft_score&#39;: 1.0, &#39;rag_score&#39;: 1.0, &#39;base_score&#39;: 0.0}
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>query</th>
      <th>gt_response</th>
      <th>ft_rag_response</th>
      <th>ft_response</th>
      <th>rag_response</th>
      <th>base_response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>How is the decision made whether to use safety context distillation or not?</td>
      <td>The decision to use safety context distillation is made based on the reward model score. The safety reward model is leveraged to determine whether the context-distilled output receives a better reward model score than the original answer. If the context-distilled output gets a better reward model score, it is kept. This approach helps limit the negative impact of context distillation while still utilizing it in cases where it improves the reward model score.</td>
      <td>The decision on whether to use safety context distillation or not is made based on the reward model score. The safety reward model is leveraged to determine whether the context-distilled output is preferred over the original answer. Safety context distillation is only kept on examples where it receives a better reward model score. This approach helps to limit the negative impact of context distillation while still improving the model's responses on prompts that it is not good at.</td>
      <td>assistant: The decision to use safety context distillation is made based on the reward model score. If the reward model score is higher than a certain threshold, safety context distillation is used.</td>
      <td>The decision to use safety context distillation is made based on the reward model score. The safety reward model is used to evaluate whether the context-distilled output gets a better reward model score than the original answer. If the context-distilled output receives a better reward model score, it is kept. This approach helps limit the negative impact of context distillation while still improving the safety of the model's responses.</td>
      <td>assistant: The decision to use safety context distillation in the Llama 2 paper is based on the nature of the situation and the need for safety. If the model is in a situation where it needs to generate safe responses, then safety context distillation is used. This is particularly important when the model is interacting with users in real-time, where there's a need to ensure that the outputs are safe and appropriate. The decision is not explicitly mentioned in the paper but is inferred from the context and the purpose of safety context distillation.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_dict</span><span class="p">,</span> <span class="n">raw_response_df</span><span class="p">,</span> <span class="n">sub_responses_df</span> <span class="o">=</span> <span class="n">run_evals</span><span class="p">(</span><span class="n">eval_dicts</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">eval_dict</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sub_responses_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "71282adcc74b4626b31a9fb6727428d6", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ft_rag_score&#39;: 1.0, &#39;ft_score&#39;: 0.0, &#39;rag_score&#39;: 1.0, &#39;base_score&#39;: 0.0}
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>query</th>
      <th>gt_response</th>
      <th>ft_rag_response</th>
      <th>ft_response</th>
      <th>rag_response</th>
      <th>base_response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>What model is used to predict the truthfulness and informativeness of the generated outputs from LLMs?</td>
      <td>A fine-tuned GPT-3 model, referred to as "GPT-judge," is used to predict the truthfulness and informativeness of the generated outputs from LLMs.</td>
      <td>A fine-tuned GPT-3 model, also known as a "GPT-judge," is used to predict the truthfulness and informativeness of the generated outputs from LLMs.</td>
      <td>assistant: The model used to predict the truthfulness and informativeness of the generated outputs from LLMs is called TruthfulQA.</td>
      <td>A fine-tuned GPT-3 model, referred to as a "GPT-judge," is used to predict the truthfulness and informativeness of the generated outputs from LLMs.</td>
      <td>assistant: The Llama 2 paper does not specify a particular model used to predict the truthfulness and informativeness of the generated outputs from Language Models. The paper primarily focuses on the limitations and risks of large language models and does not delve into specific methods or models for evaluating truthfulness or informativeness.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="quantitative-evaluations">
<h4>Quantitative Evaluations<a class="headerlink" href="#quantitative-evaluations" title="Permalink to this heading"></a></h4>
<p>Here we show quantitative metrics over both the training and eval set.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">40</span>

<span class="n">train_dicts_sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">train_dicts</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">eval_dicts_sample</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">eval_dicts</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_train</span><span class="p">,</span> <span class="n">raw_response_df</span><span class="p">,</span> <span class="n">sub_responses_df</span> <span class="o">=</span> <span class="n">run_evals</span><span class="p">(</span><span class="n">train_dicts_sample</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result_train</span><span class="p">)</span>
<span class="c1"># display(raw_response_df)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d35989347b4442e78e8307ce1662a661", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ft_rag_score&#39;: 0.75, &#39;ft_score&#39;: 0.45, &#39;rag_score&#39;: 0.7, &#39;base_score&#39;: 0.3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at where ft_rag_score did well but rag didn&#39;t</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">raw_response_df</span>
<span class="n">d</span><span class="p">[(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;ft_rag_eval&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;rag_eval&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>query</th>
      <th>gt_response</th>
      <th>ft_rag_response</th>
      <th>ft_response</th>
      <th>rag_response</th>
      <th>base_response</th>
      <th>ft_rag_eval</th>
      <th>ft_eval</th>
      <th>rag_eval</th>
      <th>base_eval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11</th>
      <td>What is the five-shot performance of Llama 2 with a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark?</td>
      <td>The five-shot performance of Llama 2 with a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark is 78.5.</td>
      <td>The five-shot performance of Llama 2 with a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark is 78.5.</td>
      <td>assistant: The five-shot performance of Llama 2 with a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark is 82.7.</td>
      <td>The five-shot performance of Llama 2 with a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark is 85.0.</td>
      <td>assistant: The Llama 2 paper does not provide specific information on the five-shot performance of a 70B model on the Massive Multitask Language Understanding (MMLU) benchmark. Please refer to the original paper or contact the authors for the most accurate information.</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>What is the role of third-party SFT data in the fine-tuning process of the Llama 2 model?</td>
      <td>The role of third-party SFT data in the fine-tuning process of the Llama 2 model is to provide additional examples for aligning the model towards dialogue-style instructions. However, the context does not provide specific details about how the third-party SFT data is utilized in the fine-tuning process.</td>
      <td>The role of third-party SFT data in the fine-tuning process of the Llama 2 model is to align LLMs (Language Model Models) towards dialogue-style instructions. However, it has been found that many of these third-party SFT datasets have insufficient diversity and quality. As a result, the focus was shifted to collecting several thousand examples of high-quality SFT data. By using fewer but higher-quality examples from vendor-based annotation efforts, the results notably improved. The findings are similar to previous research that suggests a limited set of clean instruction-tuning data can be sufficient to achieve a high level of quality. It was found that tens of thousands of SFT annotations were enough to achieve a high-quality result in the fine-tuning process of the Llama 2 model.</td>
      <td>assistant: The role of third-party SFT data in the fine-tuning process of the Llama 2 model is to provide additional training data for certain categories. This data is used to improve the performance of the model in those specific categories.</td>
      <td>The context does not provide information about the role of third-party SFT data in the fine-tuning process of the Llama 2 model.</td>
      <td>assistant: I'm sorry for any confusion, but as of my current knowledge, there is no specific model called "Llama 2". Therefore, I can't provide information about the role of third-party SFT data in its fine-tuning process. However, I can tell you that in general, third-party SFT (Supervised Fine-Tuning) data is often used in machine learning to improve the performance of a model by training it on a specific task. If you have any more details or if there's a specific context, I'd be happy to help further!</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>What measures have been taken to mitigate the generation of harmful, offensive, or biased content by Llama 2?</td>
      <td>Efforts have been made to mitigate the generation of harmful, offensive, or biased content by Llama 2. The model has undergone fine-tuning to address these issues, although some issues may still remain, especially for languages other than English where publicly available datasets were not available. OpenAI acknowledges the potential for harmful, offensive, or biased content due to the training on publicly available online datasets. They have attempted to balance safety with helpfulness, but in some instances, the safety tuning may go too far, resulting in an overly cautious approach. OpenAI encourages users of Llama 2 to be cautious and take extra steps in tuning and deployment as described in their Responsible Use Guide.</td>
      <td>Instruction fine-tuning has been used to mitigate the generation of harmful, offensive, or biased content by Llama 2. This process has shown to effectively reduce the percentage of toxic model generations, resulting in an effectively zero percentage of toxic generations for the fine-tuned Llama 2-Chat models of all sizes. The results of the toxicity analysis for the fine-tuned models are not presented in Table 45 because of this significant reduction in toxic content generation.</td>
      <td>assistant: Llama 2 has been trained on a filtered and curated dataset to mitigate the generation of harmful, offensive, or biased content. Additionally, a reward model has been used to fine-tune Llama 2-Chat to further align the model with human preferences and to reduce the generation of harmful and untruthful outputs. The reward model is based on the comparison of model responses, where human annotators rank the responses according to their quality. This iterative process of training and evaluation has helped in mitigating the generation of harmful, offensive, or biased content by Llama 2.</td>
      <td>Llama 2 has taken measures to mitigate the generation of harmful, offensive, or biased content. One of the measures is the use of the ToxiGen dataset, which contains implicitly toxic and benign sentences mentioning minority groups. Llama 2 uses a revised version of this dataset to reduce noise and filter out prompts for which annotators disagree on the target demographic group. Additionally, Llama 2 employs a default ToxiGen classifier tuned on RoBERTa to measure the toxicity of its generations. Furthermore, Llama 2 conducts a sentiment analysis using the Valence Aware Dictionary and Sentiment Reasoner (VADER) to evaluate the sentiments conveyed by the combination of prompt prefix and model generation. These measures help in analyzing and addressing the potential biases and toxicity in the generated content.</td>
      <td>assistant: The Llama 2 paper does not provide specific details on measures taken to mitigate the generation of harmful, offensive, or biased content. However, it's common for AI models like Llama 2 to incorporate various strategies to ensure responsible use. These may include the use of reinforcement learning from human feedback to reduce harmful and untruthful outputs, and the use of guidelines for human reviewers during the fine-tuning process to avoid potential biases. Additionally, efforts are often made to improve the default behavior of the system, and provide users with customization options to define the AI's values within broad bounds. Please refer to the original source or the organization behind Llama 2 for more specific information.</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_eval</span><span class="p">,</span> <span class="n">raw_response_df</span><span class="p">,</span> <span class="n">sub_responses_df</span> <span class="o">=</span> <span class="n">run_evals</span><span class="p">(</span><span class="n">eval_dicts_sample</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">result_eval</span><span class="p">)</span>
<span class="c1"># display(raw_response_df)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f8f8685cefb14e529baf3e97c2e469e2", "version_major": 2, "version_minor": 0}</script><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;ft_rag_score&#39;: 0.825,
 &#39;ft_score&#39;: 0.375,
 &#39;rag_score&#39;: 0.775,
 &#39;base_score&#39;: 0.225}
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../cross_encoder_finetuning/cross_encoder_finetuning.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to Finetune a cross-encoder using LLamaIndex</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="finetune_retrieval_aug.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Fine-tuning with Retrieval Augmentation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Jerry Liu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link" href="https://readthedocs.org/projects/gpt-index" aria-label="On Read the Docs">
                <svg x="0px" y="0px" viewBox="-125 217 360 360" xml:space="preserve">
                  <path fill="currentColor" d="M39.2,391.3c-4.2,0.6-7.1,4.4-6.5,8.5c0.4,3,2.6,5.5,5.5,6.3 c0,0,18.5,6.1,50,8.7c25.3,2.1,54-1.8,54-1.8c4.2-0.1,7.5-3.6,7.4-7.8c-0.1-4.2-3.6-7.5-7.8-7.4c-0.5,0-1,0.1-1.5,0.2 c0,0-28.1,3.5-50.9,1.6c-30.1-2.4-46.5-7.9-46.5-7.9C41.7,391.3,40.4,391.1,39.2,391.3z M39.2,353.6c-4.2,0.6-7.1,4.4-6.5,8.5 c0.4,3,2.6,5.5,5.5,6.3c0,0,18.5,6.1,50,8.7c25.3,2.1,54-1.8,54-1.8c4.2-0.1,7.5-3.6,7.4-7.8c-0.1-4.2-3.6-7.5-7.8-7.4 c-0.5,0-1,0.1-1.5,0.2c0,0-28.1,3.5-50.9,1.6c-30.1-2.4-46.5-7.9-46.5-7.9C41.7,353.6,40.4,353.4,39.2,353.6z M39.2,315.9 c-4.2,0.6-7.1,4.4-6.5,8.5c0.4,3,2.6,5.5,5.5,6.3c0,0,18.5,6.1,50,8.7c25.3,2.1,54-1.8,54-1.8c4.2-0.1,7.5-3.6,7.4-7.8 c-0.1-4.2-3.6-7.5-7.8-7.4c-0.5,0-1,0.1-1.5,0.2c0,0-28.1,3.5-50.9,1.6c-30.1-2.4-46.5-7.9-46.5-7.9 C41.7,315.9,40.4,315.8,39.2,315.9z M39.2,278.3c-4.2,0.6-7.1,4.4-6.5,8.5c0.4,3,2.6,5.5,5.5,6.3c0,0,18.5,6.1,50,8.7 c25.3,2.1,54-1.8,54-1.8c4.2-0.1,7.5-3.6,7.4-7.8c-0.1-4.2-3.6-7.5-7.8-7.4c-0.5,0-1,0.1-1.5,0.2c0,0-28.1,3.5-50.9,1.6 c-30.1-2.4-46.5-7.9-46.5-7.9C41.7,278.2,40.4,278.1,39.2,278.3z M-13.6,238.5c-39.6,0.3-54.3,12.5-54.3,12.5v295.7 c0,0,14.4-12.4,60.8-10.5s55.9,18.2,112.9,19.3s71.3-8.8,71.3-8.8l0.8-301.4c0,0-25.6,7.3-75.6,7.7c-49.9,0.4-61.9-12.7-107.7-14.2 C-8.2,238.6-10.9,238.5-13.6,238.5z M19.5,257.8c0,0,24,7.9,68.3,10.1c37.5,1.9,75-3.7,75-3.7v267.9c0,0-19,10-66.5,6.6 C59.5,536.1,19,522.1,19,522.1L19.5,257.8z M-3.6,264.8c4.2,0,7.7,3.4,7.7,7.7c0,4.2-3.4,7.7-7.7,7.7c0,0-12.4,0.1-20,0.8 c-12.7,1.3-21.4,5.9-21.4,5.9c-3.7,2-8.4,0.5-10.3-3.2c-2-3.7-0.5-8.4,3.2-10.3c0,0,0,0,0,0c0,0,11.3-6,27-7.5 C-16,264.9-3.6,264.8-3.6,264.8z M-11,302.6c4.2-0.1,7.4,0,7.4,0c4.2,0.5,7.2,4.3,6.7,8.5c-0.4,3.5-3.2,6.3-6.7,6.7 c0,0-12.4,0.1-20,0.8c-12.7,1.3-21.4,5.9-21.4,5.9c-3.7,2-8.4,0.5-10.3-3.2c-2-3.7-0.5-8.4,3.2-10.3c0,0,11.3-6,27-7.5 C-20.5,302.9-15.2,302.7-11,302.6z M-3.6,340.2c4.2,0,7.7,3.4,7.7,7.7s-3.4,7.7-7.7,7.7c0,0-12.4-0.1-20,0.7 c-12.7,1.3-21.4,5.9-21.4,5.9c-3.7,2-8.4,0.5-10.3-3.2c-2-3.7-0.5-8.4,3.2-10.3c0,0,11.3-6,27-7.5C-16,340.1-3.6,340.2-3.6,340.2z" />
                </svg>
              </a><a class="muted-link" href="https://github.com/jerryjliu/gpt_index" aria-label="On GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Fine-tuning to Memorize Knowledge</a><ul>
<li><a class="reference internal" href="#load-data">Load Data</a></li>
<li><a class="reference internal" href="#generate-dataset">Generate Dataset</a><ul>
<li><a class="reference internal" href="#filter-out-questions-using-relevancyevaluator">Filter out questions using RelevancyEvaluator</a></li>
<li><a class="reference internal" href="#split-into-training-and-validation-sets">Split into Training and Validation Sets</a></li>
<li><a class="reference internal" href="#format-into-training-data">Format into Training Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fine-tune-the-model">Fine-tune the Model</a></li>
<li><a class="reference internal" href="#evaluate-results">Evaluate Results</a><ul>
<li><a class="reference internal" href="#setup-baseline-rag-system-to-benchmark">Setup Baseline RAG system to benchmark</a></li>
<li><a class="reference internal" href="#run-evaluations">Run Evaluations</a><ul>
<li><a class="reference internal" href="#qualitative-evaluations">Qualitative Evaluations</a></li>
<li><a class="reference internal" href="#quantitative-evaluations">Quantitative Evaluations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script async="async" src="/_/static/javascript/readthedocs-doc-embed.js"></script>
    <script src="../../../_static/js/mendablesearch.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3.3.3/dist/umd/index.js"></script>
    <script defer="defer" src="../../../_static/js/algolia.js"></script>
    </body>
</html>